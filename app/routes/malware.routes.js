
module.exports = app => {
    const { check } = require('express-validator/check');
    const malwares = require('../controllers/malware.controller');
    const router = require("express").Router();

    router.post("/urlinfo/1/create", check('address').not().isEmpty().withMessage("Address can't be empty") ,malwares.create);

    router.get("/urlinfo/1/:hostname/*", malwares.findURL);
    router.use("/urlinfo/1/:hostname", malwares.findURL);
    app.use('/', router);
}