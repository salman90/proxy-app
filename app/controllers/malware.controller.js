const db  = require("../models");
const MalwareURL = db.malware;
const Op = db.Sequelize.Op;

exports.create = (req, res) => {

    const url = {
        address: req.body.address,
    };


    // res.send("hello salman")

    MalwareURL.create(url)
        .then(data => {
            res.send(data);
        })
        .catch(err => {
            res.status(500).send({
                message:
                    err.message || "Some error occurred while creating the Tutorial."
            });
        });

};


exports.findAll = (req, res) => {
    const address = req.query.title;
    let exists = address ? { adress: { [Op.like]: `%${address}%` } } : null;
    MalwareURL.findAll({ where: exists})
        .then(data => {
            res.send(data);
        })
        .catch(err => {
            res.status(500).send({
                message:
                    err.message || "Some error occurred while retrieving tutorials."
            });
        });

};


exports.findURL = (req, res) => {
    // console.log(req.params);
    // console.log(req.query);
    // let url = req.params.hostname + "/" + req.params[0] + "?"+ req.query;
    console.log(req.params)
    console.log(req.query)
    // const project = await Project.findOne({ where: { title: 'My Title' } });

    MalwareURL.findOne({ where: { address: req.params.hostname} })
     .then(data => {
         if(data != null){
             res.send(data);
         }else {
             res.send("can't find data")
         }
     }).catch(err => {
         console.log(err)
     })

    // let exists = address ? { adress: { [Op.like]: `%${address}%` } } : null;


}