/**
 * routes for applciaiton
 * @param {Object} app
 */
module.exports = app => {
    const { check } = require('express-validator/check');
    const malwares = require('../controllers/malware.controller');
    const router = require("express").Router();

    router.post("/urlinfo/1/create", 
    check('address')
    .not()
    .isEmpty()
    .withMessage("Address can't be empty") 
    .matches(/^(www.)?[a-z0-9]+(\.[a-z]{2,}){1,3}(#?\/?[a-zA-Z0-9#]+)*\/?(\?[a-zA-Z0-9-_]+=[a-zA-Z0-9-%]+&?)?$/)
    .withMessage("Pattern does not match")
    ,malwares.create);

    router.get("/urlinfo/1/:hostname/*", malwares.findURL);
    router.use("/urlinfo/1/:hostname", malwares.findURL);
    app.use('/', router);
}